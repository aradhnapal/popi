<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Header with Tabs & Settings</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="./css/style.css">
  <!-- Libraries for Excel and PDF export -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>

<body>
  <!-- Responsive Header with Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid ">
      <!-- Logo -->
      <a class="navbar-brand" href="#">
        <a class="navbar-brand" href="#">
          <img src="images/logo.png" alt="Logo" style="height:40px;">
        </a>
        <!-- Hamburger Toggler -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
          aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <!-- Collapsible Content -->
        <div class="collapse navbar-collapse" id="navbarContent">
          <!-- Tabs -->
          <ul class="navbar-nav m-auto mb-2 mb-lg-0 nav-tabs border-0" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="admin-tab" data-bs-toggle="tab" data-bs-target="#admin" type="button"
                role="tab">Admin</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button"
                role="tab">Dashboard</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="summary-tab" data-bs-toggle="tab" data-bs-target="#summary" type="button"
                role="tab">Summary</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="po-tab" data-bs-toggle="tab" data-bs-target="#po" type="button" role="tab">
                PO_PI Tracker</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link " id="quotation-tab" data-bs-toggle="tab" data-bs-target="#quotation"
                type="button" role="tab">Quotation Tracker</button>
            </li>
          </ul>
          <!-- Settings Dropdown -->
          <div class="dropdown">
            <button class="btn settings-btn dropdown-toggle d-flex align-items-center gap-2" type="button"
              id="settingsDropdown" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fas fa-cog"></i> <span>Settings</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end settings-menu" aria-labelledby="settingsDropdown">
              <li>
                <a class="dropdown-item text-danger" href="#">
                  <i class="fas fa-sign-out-alt me-2"></i> Logout
                </a>
              </li>
            </ul>
          </div>
        </div>
    </div>

    <style>
      /* tab css */
      .navbar {
        box-shadow: 0 4px 6px -2px rgba(0, 0, 0, 0.2);

      }

      .navbar-nav .nav-link {
        margin: 0 10px;

      }

      .settings-btn {
        background-color: #4058A7;
        border: 1px solid #ddd;
        border-radius: 5px;
      }

      .settings-menu {
        min-width: 150px;
      }

      .text-red {
        color: red;
      }

      .edit-icon {
        cursor: pointer;
      }

      .btn-action {
        margin: 5px;
      }

      .container-fluid {
        margin-bottom: -10px;
      }

      .navbar-nav .nav-link {
        min-width: 150px;
        text-align: center;
        margin: 0 5px;
        padding: 10px 15px;
      }

      .settings-menu {
        min-width: 150px;
      }

      .edit-icon {
        cursor: pointer;
      }

      .btn-action {
        margin: 5px;
      }

      @media (max-width: 991px) {
        .navbar-nav .nav-link {
          min-width: 100%;
          text-align: left;
        }
      }

      .nav-tabs .nav-link {
        color: #3b4a9a;
        border: none;
        background-color: transparent;
        font-weight: 500;
      }

      .nav-tabs .nav-link.active {
        background-color: #4058A7 !important;
        color: white !important;
      }

      .settings-btn {
        background-color: #4058A7;
        color: white;
        border-radius: 5px;
        padding: 5px 10px;
      }

      .settings-btn:hover {
        background-color: darkblue;
        color: white;
      }

      .settings-menu {
        background: white;
        border-radius: 5px;
      }
    </style>
  </nav>

  <!-- Tab Content -->
  <div class="tab-content p-4" id="myTabContent">
    <!-- admin tab start -->
    <div class="tab-pane fade show active " id="admin" role="tabpanel" aria-labelledby="admin-tab">
      <style>
        .custom-tabs {
          border: none;
          padding: 10px;
          border-radius: 50px;
          display: flex;
          justify-content: flex-end;
        }

        .custom-tabs .custom-tab-link {
          border-radius: 50px;
          padding: 8px 20px;
          font-weight: 500;
          color: #3b4a9a;
          border: 1px solid #ddd;
          margin-left: 8px;
          width: 180px;
          text-align: center;
          background-color: transparent;
        }

        .custom-tabs .custom-tab-link.active {
          background-color: #3b4a9a;
          color: #fff;
          border: none;
        }

        .custom-card {
          border-radius: 8px;
          padding: 15px;
          background-color: #fff;
          box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        }

        .custom-card h6 {
          padding-bottom: 8px;
          margin-bottom: 15px;
          text-align: left;
        }

        .page-title {
          font-size: 1.5rem;
          font-weight: bold;
          text-align: left;
          margin: 0;
        }

        .table td {
          border-bottom: none;
        }

        .table th {
          border-bottom: 1px solid #dee2e6;
        }

        .btn-add {
          background-color: #4058A7;
          color: #fff;
          border-radius: 6px;
          font-size: 14px;
          margin-top: 10px;
        }

        .btn-add:hover {
          background-color: #2c4cc7;
          color: #fff;
        }

        .action-icons i {
          cursor: pointer;
          margin-right: 8px;
          font-size: 16px;
          color: #fff;
          background-color: #4058A7;
          padding: 6px;
          border-radius: 4px;
          width: 28px;
          height: 28px;
          display: inline-flex;
          align-items: center;
          justify-content: center;
        }

        .action-icons i:hover {
          background-color: #2c4cc7;
        }

        .custom-modal {
          border: 1.5px solid #4058A7;
          border-radius: 8px;
          padding: 20px;
          background: #fff;
          max-width: 1200px;
          margin: 80px auto;
          box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
          position: relative;
        }

        .custom-modal .form-control {
          border-radius: 10px;
          border: 1px solid #4058A7;
          padding: 12px;
        }

        .btn-cancel {
          border: 1px solid #4058A7;
          border-radius: 25px;
          background: #fff;
          color: #4058A7;
          padding: 8px 20px;
        }

        .btn-update,
        .btn-primary {
          border-radius: 25px;
          background: #4058A7;
          color: #fff;
          padding: 8px 20px;
        }

        .close-btn {
          position: absolute;
          right: 15px;
          top: 10px;
          border: 1px solid #4058A7;
          border-radius: 5px;
          width: 28px;
          height: 28px;
          background: #fff;
          text-align: center;
          line-height: 20px;
          font-size: 18px;
          cursor: pointer;
        }

        .btn:hover {
          background-color: #2c4cc7;
          border-color: #2c4cc7;
          color: #fff;
        }

        .perms-pills .nav-link {
          border: 1px solid #3b5ba5;
          border-radius: 999px;
          padding: 6px 14px;
          color: #3b5ba5;
          background: #fff;
          font-weight: 500;
        }

        .perms-pills .nav-link.active {
          background: #3b5ba5;
          color: #fff;
        }

        .modules-list li,
        .modules-access li {
          padding: 6px 0;
        }

        .perm-block {
          border: 1px solid #e6e8f0;
          border-radius: 10px;
          padding: 12px;
          background: #fff;
        }

        .perm-head {
          display: grid;
          grid-template-columns: 1fr 70px 70px;
          font-weight: 600;
          font-size: 14px;
          margin-bottom: 8px;
        }

        .perm-head .title {
          color: #3b5ba5;
        }

        .perm-head .rw {
          text-align: center;
          color: #3b5ba5;
        }

        .perm-grid {
          display: grid;
          grid-template-columns: 1fr 70px 70px;
          row-gap: 8px;
          align-items: center;
          font-size: 14px;
        }

        .perm-grid .label {
          padding-right: 8px;
        }

        .perm-grid .check {
          text-align: center;
        }

        .form-check-input {
          cursor: pointer;
        }
      </style>

      <div class="container py-4">
        <div class="d-flex flex-wrap justify-content-between align-items-center mb-4">
          <h5 class="page-title">User Role</h5>
          <ul class="nav custom-tabs" id="roleTabs" role="tablist">
            <li class="nav-item">
              <button class="nav-link custom-tab-link active" id="manage-tab" data-bs-toggle="tab"
                data-bs-target="#manage" type="button" role="tab" onclick="updatePageTitle('Manage User Role')">Manage
                User Role</button>
            </li>
            <li class="nav-item">
              <button class="nav-link custom-tab-link" id="users-tab" data-bs-toggle="tab" data-bs-target="#users"
                type="button" role="tab" onclick="updatePageTitle('All User')">All User</button>
            </li>
            <li class="nav-item">
              <button class="nav-link custom-tab-link" id="resorts-tab" data-bs-toggle="tab" data-bs-target="#resorts"
                type="button" role="tab" onclick="updatePageTitle('Resorts')">Resorts</button>
            </li>
          </ul>
        </div>

        <div class="custom-card">
          <div class="tab-content p-0" id="roleTabsContent">
            <div class="tab-pane fade show active" id="manage" role="tabpanel">
              <h6>All Roles</h6>
              <table class="table table-sm align-middle" id="rolesTable">
                <thead>
                  <tr>
                    <th style="width: 70px;">Sr. No.</th>
                    <th>Role Name</th>
                  </tr>
                </thead>
                <tbody id="rolesTableBody">
                  <tr>
                    <td>1</td>
                    <td>Admin</td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>Purchase</td>
                  </tr>
                  <tr>
                    <td>3</td>
                    <td>Account Team</td>
                  </tr>
                  <tr>
                    <td>4</td>
                    <td>Resort</td>
                  </tr>
                </tbody>
              </table>
              <div class="text-end">
                <button class="btn btn-add" data-bs-toggle="modal" data-bs-target="#editModal">Add New Role</button>
              </div>
              <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content custom-modal" style="max-width: 500px;">
                    <button class="close-btn" data-bs-dismiss="modal">&times;</button>
                    <h5 class="mb-4 fw-bold">Add New Role</h5>
                    <div class="modal-body">
                      <div class="mb-4">
                        <input type="text" class="form-control" id="roleNameInput" placeholder="Enter Role Name">
                      </div>
                      <div class="d-flex justify-content-end gap-2">
                        <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-update" id="submitRole">Submit</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="tab-pane fade" id="users" role="tabpanel">
              <h6>All Users</h6>
              <table class="table table-sm align-middle" id="usersTable">
                <thead>
                  <tr>
                    <th style="width: 70px;">Sr. No.</th>
                    <th>Name</th>
                    <th>Department</th>
                    <th>Email</th>
                    <th>Phone Number</th>
                    <th>Status</th>
                    <th style="width: 100px;">Actions</th>
                  </tr>
                </thead>
                <tbody id="usersTableBody">
                  <tr>
                    <td>1</td>
                    <td>John Doe</td>
                    <td>Admin</td>
                    <td>john@example.com</td>
                    <td>+1 234-567-8900</td>
                    <td>Active</td>
                    <td class="action-icons">
                      <i class="fas fa-edit" onclick="editUser(this)"></i>
                      <i class="fas fa-trash" onclick="deleteUser(this)"></i>
                    </td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>Jane Smith</td>
                    <td>Accounts</td>
                    <td>jane@example.com</td>
                    <td>+1 987-654-3210</td>
                    <td>Inactive</td>
                    <td class="action-icons">
                      <i class="fas fa-edit" onclick="editUser(this)"></i>
                      <i class="fas fa-trash" onclick="deleteUser(this)"></i>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div class="text-end">
                <button type="button" class="btn btn-add" data-bs-toggle="modal" data-bs-target="#addUserModal">
                  Add New User
                </button>
              </div>
              <!-- Modal for Adding/Editing User -->
              <div class="modal fade" id="addUserModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-xl modal-dialog-centered">
                  <div class="modal-content custom-modal">
                    <button class="close-btn" data-bs-dismiss="modal">&times;</button>
                    <h5 class="mb-4 fw-bold">Add New User</h5>
                    <div class="modal-body">
                      <!-- Top Inputs -->
                      <div class="row g-3">
                        <div class="col-md-6">
                          <label for="firstName" class="form-label">First Name</label>
                          <input type="text" class="form-control" id="firstName" name="firstName"
                            placeholder="First Name" />
                        </div>
                        <div class="col-md-6">
                          <label for="lastName" class="form-label">Last Name</label>
                          <input type="text" class="form-control" id="lastName" name="lastName"
                            placeholder="Last Name" />
                        </div>
                        <div class="col-md-6">
                          <label for="emailId" class="form-label">Email Id</label>
                          <input type="email" class="form-control" id="emailId" name="email" placeholder="Email Id" />
                        </div>
                        <div class="col-md-6">
                          <label for="department" class="form-label">Role</label>
                          <select class="form-control" id="department" name="department">
                            <option value="Purchase">Purchase</option>
                            <option value="Admin">Admin</option>
                            <option value="Accounts">Accounts</option>
                            <option value="Resort">Resort</option>
                          </select>
                        </div>
                        <div class="col-md-6">
                          <label for="phoneNumber" class="form-label">Phone Number</label>
                          <input type="text" class="form-control" id="phoneNumber" name="phone"
                            placeholder="Phone Number" />
                        </div>
                        <div class="col-md-6 d-flex align-items-center">
                          <label class="me-2 fw-bold">Status</label>
                          <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="statusSwitch" name="status" checked />
                            <label class="form-check-label" for="statusSwitch">Active</label>
                          </div>
                        </div>
                      </div>
                      <hr class="my-4" />
                      <!-- Head row: labels + pills -->
                      <div class="row align-items-center mb-2 g-2">
                        <div class="col-lg-2 col-4">
                          <h6 class="mb-0">Modules</h6>
                        </div>
                        <div class="col-lg-2 col-4">
                          <h6 class="mb-0">Access</h6>
                        </div>
                        <div class="col-lg-8 col-12">
                          <ul class="nav nav-pills gap-2 justify-content-start perms-pills" id="userTab" role="tablist">
                            <li class="nav-item" role="presentation">
                              <button class="nav-link active" id="qt-pill" data-bs-toggle="tab" data-bs-target="#tab-qt"
                                type="button">
                                Quotation Tracker
                              </button>
                            </li>
                            <li class="nav-item" role="presentation">
                              <button class="nav-link" id="po-pill" data-bs-toggle="tab" data-bs-target="#tab-po"
                                type="button">
                                PO_PI Tracker
                              </button>
                            </li>
                            <li class="nav-item" role="presentation">
                              <button class="nav-link" id="resort-pill" data-bs-toggle="tab"
                                data-bs-target="#tab-resort" type="button">
                                Resort
                              </button>
                            </li>
                          </ul>
                        </div>
                      </div>
                      <!-- ONE ROW: left (modules+access) + right (tab content) -->
                      <div class="row g-3 align-items-start">
                        <!-- LEFT: Modules + Access -->
                        <div class="col-lg-4">
                          <div class="row">
                            <div class="col-6">
                              <ul class="list-unstyled small mb-0 modules-list">
                                <li>PO_PI Tracker</li>
                                <li>Quotation Tracker</li>
                                <li>Admin</li>
                                <li>Dashboard</li>
                                <li>Summary</li>
                              </ul>
                            </div>
                            <div class="col-6">
                              <ul class="list-unstyled small mb-0 modules-access">
                                <li><input class="form-check-input me-2" type="checkbox" checked /></li>
                                <li><input class="form-check-input me-2" type="checkbox" checked /></li>
                                <li><input class="form-check-input me-2" type="checkbox" /></li>
                                <li><input class="form-check-input me-2" type="checkbox" /></li>
                                <li><input class="form-check-input me-2" type="checkbox" checked /></li>
                              </ul>
                            </div>
                          </div>
                        </div>
                        <!-- RIGHT: Tab panes -->
                        <div class="col-lg-8">
                          <div class="tab-content">
                            <!-- Quotation Tracker TAB -->
                            <div class="tab-pane fade show active" id="tab-qt" role="tabpanel"
                              aria-labelledby="qt-pill">
                              <div class="row g-3">
                                <!-- LEFT permission block -->
                                <div class="col-md-6">
                                  <div class="perm-block">
                                    <div class="perm-head">
                                      <span class="title">Access</span>
                                      <span class="rw">Read</span>
                                      <span class="rw">Write</span>
                                    </div>
                                    <div class="perm-grid">
                                      <div class="label">Enquiry Number</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Enq. Received Date</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Sender's Email ID</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Client Name</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Email Subject Line</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Product Category</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Enq. Product Status</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Assigned To</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">SLA</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" checked />
                                      </div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                    </div>
                                  </div>
                                </div>
                                <!-- RIGHT permission block -->
                                <div class="col-md-6">
                                  <div class="perm-block">
                                    <div class="perm-head">
                                      <span class="title">Access</span>
                                      <span class="rw">Read</span>
                                      <span class="rw">Write</span>
                                    </div>
                                    <div class="perm-grid">
                                      <div class="label">Quotation Sent Status</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" checked />
                                      </div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Zoho Quotation No.</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Multiple Quotation</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Quotation Sent Date</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" checked />
                                      </div>
                                      <div class="label">SLA Status</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" checked />
                                      </div>
                                      <div class="label">CENPRO Remark</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Resort Remark</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" checked />
                                      </div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <!-- PO_PI Tracker TAB -->
                            <div class="tab-pane fade" id="tab-po" role="tabpanel" aria-labelledby="po-pill">
                              <div class="row g-3">
                                <div class="col-md-6">
                                  <div class="perm-block">
                                    <div class="perm-head">
                                      <span class="title">Access</span>
                                      <span class="rw">Read</span>
                                      <span class="rw">Write</span>
                                    </div>
                                    <div class="perm-grid">
                                      <div class="label">PO Number</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" checked />
                                      </div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">PI Number</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Supplier Name</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Currency</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-md-6">
                                  <div class="perm-block">
                                    <div class="perm-head">
                                      <span class="title">Access</span>
                                      <span class="rw">Read</span>
                                      <span class="rw">Write</span>
                                    </div>
                                    <div class="perm-grid">
                                      <div class="label">Amount</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">PO Date</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                      <div class="label">Status</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" checked />
                                      </div>
                                      <div class="check"><input class="form-check-input" type="checkbox" /></div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <!-- Resort TAB -->
                            <div class="tab-pane fade" id="tab-resort" role="tabpanel" aria-labelledby="resort-pill">
                              <div class="row g-3">
                                <div class="col-md-6">
                                  <div class="perm-block">
                                    <div class="perm-head">
                                      <span class="title">Access</span>
                                      <span class="rw">Read</span>
                                      <span class="rw">Write</span>
                                    </div>
                                    <div class="perm-grid">
                                      <div class="label">Resort Remark</div>
                                      <div class="check"><input class="form-check-input" type="checkbox" checked />
                                      </div>
                                      <div class="check"><input class="form-check-input" type="checkbox" checked />
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-md-6"></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- Submit -->
                      <div class="text-start mt-4">
                        <button class="btn btn-primary px-4">Submit</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="tab-pane fade" id="resorts" role="tabpanel">
              <h6>All Resorts</h6>
              <table class="table table-sm align-middle" id="resortsTable">
                <thead>
                  <tr>
                    <th style="width: 70px;">Sr. No.</th>
                    <th>Resorts Name</th>
                    <th>Domain Name</th>
                    <th>Display Name</th>
                    <th style="width: 100px;">Actions</th>
                  </tr>
                </thead>
                <tbody id="resortsTableBody">
                  <tr>
                    <td>1</td>
                    <td>Ozen Reserve Bolifushi</td>
                    <td>Bolifushi.com</td>
                    <td>ORB</td>
                    <td class="action-icons">
                      <i class="fas fa-edit" onclick="openEditResortModal(this)"></i>
                      <i class="fas fa-trash" onclick="deleteResort(this)"></i>
                    </td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>Resort 2</td>
                    <td>Property Domain name</td>
                    <td>Property Domain name</td>
                    <td class="action-icons">
                      <i class="fas fa-edit" onclick="openEditResortModal(this)"></i>
                      <i class="fas fa-trash" onclick="deleteResort(this)"></i>
                    </td>
                  </tr>
                  <tr>
                    <td>3</td>
                    <td>Resort 3</td>
                    <td>Property Domain name</td>
                    <td>Property Domain name</td>
                    <td class="action-icons">
                      <i class="fas fa-edit" onclick="openEditResortModal(this)"></i>
                      <i class="fas fa-trash" onclick="deleteResort(this)"></i>
                    </td>
                  </tr>
                  <tr>
                    <td>4</td>
                    <td>Resort 4</td>
                    <td>Property Domain name</td>
                    <td>Property Domain name</td>
                    <td class="action-icons">
                      <i class="fas fa-edit" onclick="openEditResortModal(this)"></i>
                      <i class="fas fa-trash" onclick="deleteResort(this)"></i>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div class="text-end">
                <button class="btn btn-add" data-bs-toggle="modal" data-bs-target="#addResortModal">Add New
                  Resort</button>
              </div>
              <!-- Modal for Editing Resorts -->
              <div class="modal fade" id="editResortModal" tabindex="-1" aria-labelledby="editResortModalLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content custom-modal" style="max-width: 500px;">
                    <button class="close-btn" data-bs-dismiss="modal">&times;</button>
                    <h5 class="mb-4 fw-bold">Update Resort</h5>
                    <div class="modal-body">
                      <div class="mb-3">
                        <input type="text" class="form-control" id="resortNameInput" placeholder="Enter Resort Name">
                      </div>
                      <div class="mb-3">
                        <input type="text" class="form-control" id="domainNameInput" placeholder="Enter Domain Name">
                      </div>
                      <div class="mb-4">
                        <input type="text" class="form-control" id="displayNameInput" placeholder="Enter Display Name">
                      </div>
                      <div class="d-flex justify-content-end gap-2">
                        <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-update" onclick="submitResortEdit()">Update</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Modal for Adding New Resort -->
              <div class="modal fade" id="addResortModal" tabindex="-1" aria-labelledby="addResortModalLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content custom-modal" style="max-width: 500px;">
                    <button class="close-btn" data-bs-dismiss="modal">&times;</button>
                    <h5 class="mb-4 fw-bold">Add New Resort</h5>
                    <div class="modal-body">
                      <div class="mb-3">
                        <input type="text" class="form-control" id="newResortNameInput" placeholder="Enter Resort Name">
                      </div>
                      <div class="mb-3">
                        <input type="text" class="form-control" id="newDomainNameInput" placeholder="Enter Domain Name">
                      </div>
                      <div class="mb-4">
                        <input type="text" class="form-control" id="newDisplayNameInput"
                          placeholder="Enter Display Name">
                      </div>
                      <div class="d-flex justify-content-end gap-2">
                        <button type="button" class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-update" onclick="submitNewResort()">Submit</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <script>
        // Ensure Bootstrap tabs are initialized correctly
        document.addEventListener('DOMContentLoaded', function () {
          // Initialize Bootstrap tabs
          const triggerTabList = document.querySelectorAll('#roleTabs button');
          triggerTabList.forEach(function (triggerEl) {
            const tabTrigger = new bootstrap.Tab(triggerEl);
            triggerEl.addEventListener('click', function (event) {
              event.preventDefault();
              tabTrigger.show();
            });
          });

          // Manually trigger the active tab on page load
          const activeTab = document.querySelector('#roleTabs .custom-tab-link.active');
          if (activeTab) {
            const tab = new bootstrap.Tab(activeTab);
            tab.show();
          }
        });

        // Update page title when tab is clicked
        function updatePageTitle(title) {
          document.querySelector('.page-title').textContent = title;
        }

        // Add new role
        document.getElementById("submitRole").addEventListener("click", function () {
          const roleName = document.getElementById("roleNameInput").value.trim();
          if (roleName) {
            const tableBody = document.getElementById("rolesTableBody");
            const newRow = document.createElement("tr");
            const rowCount = tableBody.rows.length + 1;
            newRow.innerHTML = `
                    <td>${rowCount}</td>
                    <td>${roleName}</td>
                `;
            tableBody.appendChild(newRow);
            document.getElementById("roleNameInput").value = "";
            bootstrap.Modal.getInstance(document.getElementById("editModal")).hide();
          } else {
            alert("Please enter a role name.");
          }
        });

        // User Management
        let userCount = document.querySelectorAll("#usersTableBody tr").length;

        // Update Status Label
        const statusSwitch = document.querySelector("#statusSwitch");
        const statusLabel = document.querySelector("label[for='statusSwitch']");
        statusSwitch.addEventListener("change", function () {
          statusLabel.innerText = this.checked ? "Active" : "Inactive";
        });

        // Add/Edit User
        document.querySelector("#addUserModal .btn-primary").addEventListener("click", function () {
          const firstName = document.querySelector('#addUserModal input[placeholder="First Name"]').value.trim();
          const lastName = document.querySelector('#addUserModal input[placeholder="Last Name"]').value.trim();
          const email = document.querySelector('#addUserModal input[placeholder="Email Id"]').value.trim();
          const phone = document.querySelector('#addUserModal input[placeholder="Phone Number"]').value.trim();
          const department = document.querySelector('#addUserModal select').value;
          const status = statusSwitch.checked ? "Active" : "Inactive";

          if (!firstName || !lastName || !email || !phone) {
            alert("Please fill all required fields!");
            return;
          }

          const modal = document.getElementById("addUserModal");
          const isEditMode = modal.dataset.isEdit === "true";
          const rowIndex = parseInt(modal.dataset.rowIndex) || 0;

          if (isEditMode) {
            const tableBody = document.getElementById("usersTableBody");
            const row = tableBody.rows[rowIndex];
            row.cells[1].textContent = `${firstName} ${lastName}`;
            row.cells[2].textContent = department;
            row.cells[3].textContent = email;
            row.cells[4].textContent = phone;
            row.cells[5].textContent = status;
          } else {
            userCount++;
            const newRow = `
                    <tr>
                        <td>${userCount}</td>
                        <td>${firstName} ${lastName}</td>
                        <td>${department}</td>
                        <td>${email}</td>
                        <td>${phone}</td>
                        <td>${status}</td>
                        <td class="action-icons">
                            <i class="fas fa-edit" onclick="editUser(this)"></i>
                            <i class="fas fa-trash" onclick="deleteUser(this)"></i>
                        </td>
                    </tr>
                `;
            document.querySelector("#usersTableBody").insertAdjacentHTML("beforeend", newRow);
          }

          resetModal();
        });

        // Edit User
        window.editUser = function (icon) {
          const row = icon.closest("tr");
          const cells = row.cells;
          const name = cells[1].textContent.split(" ");
          const firstName = name[0] || "";
          const lastName = name.slice(1).join(" ") || "";
          const department = cells[2].textContent;
          const email = cells[3].textContent;
          const phone = cells[4].textContent;
          const status = cells[5].textContent.trim();

          document.querySelector('#addUserModal input[placeholder="First Name"]').value = firstName;
          document.querySelector('#addUserModal input[placeholder="Last Name"]').value = lastName;
          document.querySelector('#addUserModal input[placeholder="Email Id"]').value = email;
          document.querySelector('#addUserModal input[placeholder="Phone Number"]').value = phone;
          document.querySelector('#addUserModal select').value = department;

          statusSwitch.checked = status === "Active";
          statusLabel.innerText = status === "Active" ? "Active" : "Inactive";

          const modal = document.getElementById("addUserModal");
          modal.dataset.isEdit = "true";
          modal.dataset.rowIndex = row.rowIndex - 1;
          document.querySelector("#addUserModal h5").innerText = "Edit User";
          document.querySelector("#addUserModal .btn-primary").innerText = "Update";

          new bootstrap.Modal(modal).show();
        };

        // Delete User
        window.deleteUser = function (icon) {
          if (confirm("Are you sure you want to delete this user?")) {
            const row = icon.closest("tr");
            row.remove();
            document.querySelectorAll("#usersTableBody tr").forEach((r, i) => {
              r.cells[0].textContent = i + 1;
            });
            userCount--;
          }
        };

        // Reset Modal
        function resetModal() {
          const modal = document.getElementById("addUserModal");
          modal.dataset.isEdit = "false";
          modal.dataset.rowIndex = "";
          document.querySelectorAll("#addUserModal input, #addUserModal select").forEach(el => {
            if (el.type === "checkbox") {
              el.checked = true;
            } else {
              el.value = "";
            }
          });
          document.querySelector("#addUserModal h5").innerText = "Add New User";
          document.querySelector("#addUserModal .btn-primary").innerText = "Submit";
          statusLabel.innerText = "Active";
          bootstrap.Modal.getInstance(modal).hide();
        };

        // Resort Management
        function openEditResortModal(icon) {
          const row = icon.closest("tr");
          document.getElementById("resortNameInput").value = row.cells[1].textContent;
          document.getElementById("domainNameInput").value = row.cells[2].textContent;
          document.getElementById("displayNameInput").value = row.cells[3].textContent;
          const modal = document.getElementById("editResortModal");
          modal.dataset.rowIndex = row.rowIndex - 1;
          new bootstrap.Modal(modal).show();
        }

        function submitResortEdit() {
          const resortName = document.getElementById("resortNameInput").value.trim();
          const domainName = document.getElementById("domainNameInput").value.trim();
          const displayName = document.getElementById("displayNameInput").value.trim();

          if (resortName && domainName && displayName) {
            const rowIndex = document.getElementById("editResortModal").dataset.rowIndex;
            const row = document.getElementById("resortsTableBody").rows[rowIndex];
            row.cells[1].textContent = resortName;
            row.cells[2].textContent = domainName;
            row.cells[3].textContent = displayName;
            document.getElementById("resortNameInput").value = "";
            document.getElementById("domainNameInput").value = "";
            document.getElementById("displayNameInput").value = "";
            bootstrap.Modal.getInstance(document.getElementById("editResortModal")).hide();
          } else {
            alert("Please fill in all fields.");
          }
        }

        function submitNewResort() {
          const resortName = document.getElementById("newResortNameInput").value.trim();
          const domainName = document.getElementById("newDomainNameInput").value.trim();
          const displayName = document.getElementById("newDisplayNameInput").value.trim();

          if (resortName && domainName && displayName) {
            const tableBody = document.getElementById("resortsTableBody");
            const newRow = document.createElement("tr");
            const rowCount = tableBody.rows.length + 1;
            newRow.innerHTML = `
                    <td>${rowCount}</td>
                    <td>${resortName}</td>
                    <td>${domainName}</td>
                    <td>${displayName}</td>
                    <td class="action-icons">
                        <i class="fas fa-edit" onclick="openEditResortModal(this)"></i>
                        <i class="fas fa-trash" onclick="deleteResort(this)"></i>
                    </td>
                `;
            tableBody.appendChild(newRow);
            document.getElementById("newResortNameInput").value = "";
            document.getElementById("newDomainNameInput").value = "";
            document.getElementById("newDisplayNameInput").value = "";
            bootstrap.Modal.getInstance(document.getElementById("addResortModal")).hide();
          } else {
            alert("Please fill in all fields.");
          }
        }

        function deleteResort(icon) {
          const row = icon.closest("tr");
          const tableBody = document.getElementById("resortsTableBody");
          tableBody.removeChild(row);
          const rows = tableBody.querySelectorAll("tr");
          rows.forEach((row, index) => {
            row.cells[0].textContent = index + 1;
          });
        }
      </script>
    </div>

    <div class="tab-pane fade" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
      <h4>Dashboard</h4>
      <p>Here you can manage users, add new ones, edit roles, and more.</p>
    </div>
    <div class="tab-pane fade" id="summary" role="tabpanel" aria-labelledby="summary-tab">
      <style>
        /* Summary + Tabs row */
        .summary-tabs {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
        }

        .summary-title {
          font-weight: 600;
          margin: 0;
        }

        /* Card / Table container */
        .custom-card {
          border: 1px solid #dee2e6;
          border-radius: 10px;
          background: #fff;
          margin-bottom: 25px;
          overflow: hidden;
        }

        .custom-card-header {
          background: #4058A7;
          color: #fff;
          font-weight: 600;
          padding: 10px 15px;
          font-size: 14px;
          text-align: center;
        }

        .table thead {
          background: #f5f7fb;
          font-size: 14px;
        }

        .table td,
        .table th {
          padding: 8px 12px;
          vertical-align: middle;
          font-size: 14px;
        }

        .table tfoot td {
          font-weight: bold;
          background: #f9fafc;
        }

        .payment-note {
          text-align: center;
          padding: 10px;
          font-size: 14px;
          font-weight: 500;
          color: #333;
        }
      </style>

      <div class="container py-4">
        <div class="summary-tabs">
          <h6 class="summary-title">Summary</h6>
          <ul class="nav custom-tabs" id="propertyTabs" role="tablist">
            <li class="nav-item">
              <a class="nav-link custom-tab-link active" id="prop1-tab" data-bs-toggle="tab" href="#prop1"
                role="tab">Property 1</a>
            </li>
            <li class="nav-item">
              <a class="nav-link custom-tab-link" id="prop2-tab" data-bs-toggle="tab" href="#prop2" role="tab">Property
                2</a>
            </li>
            <li class="nav-item">
              <a class="nav-link custom-tab-link" id="prop3-tab" data-bs-toggle="tab" href="#prop3" role="tab">Property
                3</a>
            </li>
          </ul>
        </div>

        <!-- Tab Content -->
        <div class="tab-content" id="propertyTabsContent">
          <!-- Property 1 -->
          <div class="tab-pane fade show active" id="prop1" role="tabpanel">
            <!-- Card 1 -->
            <div class="custom-card">
              <div class="custom-card-header">OLM USD DUE AMOUNT</div>
              <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                  <thead>
                    <tr>
                      <th style="width: 60px;">Sr. No.</th>
                      <th>Category</th>
                      <th>USD Amount</th>
                      <th>Min Amount Req</th>
                      <th>Amount Received</th>
                      <th>Min Amount Due</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1</td>
                      <td>OPERATIONAL ORDERS-OVERSEAS</td>
                      <td>1000</td>
                      <td>750</td>
                      <td>750</td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>2</td>
                      <td>OPERATIONAL ORDERS-LOCAL</td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>3</td>
                      <td>CAPEX</td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>4</td>
                      <td>PROJECTS</td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                  </tbody>
                  <tfoot>
                    <tr>
                      <td colspan="2">Total</td>
                      <td>1000</td>
                      <td>750</td>
                      <td>750</td>
                      <td></td>
                    </tr>
                  </tfoot>
                </table>
              </div>
              <div class="payment-note">IMMEDIATE PAYMENT DUE AMOUNTING USD : $1000</div>
            </div>

            <!-- Card 2 -->
            <div class="custom-card">
              <div class="custom-card-header">OLM MVR DUE AMOUNT</div>
              <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                  <thead>
                    <tr>
                      <th style="width: 60px;">Sr. No.</th>
                      <th>Category</th>
                      <th>USD Amount</th>
                      <th>Min Amount Req</th>
                      <th>Amount Received</th>
                      <th>Min Amount Due</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1</td>
                      <td>OPERATIONAL ORDERS-OVERSEAS</td>
                      <td>1000</td>
                      <td>750</td>
                      <td>750</td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>2</td>
                      <td>OPERATIONAL ORDERS-LOCAL</td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>3</td>
                      <td>CAPEX</td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>4</td>
                      <td>PROJECTS</td>
                      <td></td>
                      <td></td>
                      <td></td>
                      <td></td>
                    </tr>
                  </tbody>
                  <tfoot>
                    <tr>
                      <td colspan="2">Total</td>
                      <td>1000</td>
                      <td>750</td>
                      <td>750</td>
                      <td></td>
                    </tr>
                  </tfoot>
                </table>
              </div>
              <div class="payment-note">IMMEDIATE PAYMENT DUE AMOUNTING MVR : $1000</div>
            </div>
          </div>

          <!-- Property 2 -->
          <div class="tab-pane fade" id="prop2" role="tabpanel">
            <div class="custom-card">
              <div class="custom-card-header">Property 2 - USD DUE AMOUNT</div>
              <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                  <thead>
                    <tr>
                      <th>Sr. No.</th>
                      <th>Category</th>
                      <th>USD Amount</th>
                      <th>Min Amount Req</th>
                      <th>Amount Received</th>
                      <th>Min Amount Due</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1</td>
                      <td>SAMPLE DATA</td>
                      <td>500</td>
                      <td>300</td>
                      <td>200</td>
                      <td>100</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="payment-note">IMMEDIATE PAYMENT DUE AMOUNTING USD : $500</div>
            </div>

            <div class="custom-card">
              <div class="custom-card-header">Property 2 - MVR DUE AMOUNT</div>
              <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                  <thead>
                    <tr>
                      <th>Sr. No.</th>
                      <th>Category</th>
                      <th>USD Amount</th>
                      <th>Min Amount Req</th>
                      <th>Amount Received</th>
                      <th>Min Amount Due</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1</td>
                      <td>SAMPLE DATA</td>
                      <td>900</td>
                      <td>400</td>
                      <td>300</td>
                      <td>100</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="payment-note">IMMEDIATE PAYMENT DUE AMOUNTING MVR : $900</div>
            </div>
          </div>

          <!-- Property 3 -->
          <div class="tab-pane fade" id="prop3" role="tabpanel">
            <div class="custom-card">
              <div class="custom-card-header">Property 3 - USD DUE AMOUNT</div>
              <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                  <thead>
                    <tr>
                      <th>Sr. No.</th>
                      <th>Category</th>
                      <th>USD Amount</th>
                      <th>Min Amount Req</th>
                      <th>Amount Received</th>
                      <th>Min Amount Due</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1</td>
                      <td>SAMPLE DATA</td>
                      <td>800</td>
                      <td>500</td>
                      <td>200</td>
                      <td>300</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="payment-note">IMMEDIATE PAYMENT DUE AMOUNTING USD : $800</div>
            </div>

            <div class="custom-card">
              <div class="custom-card-header">Property 3 - MVR DUE AMOUNT</div>
              <div class="table-responsive">
                <table class="table table-bordered align-middle mb-0">
                  <thead>
                    <tr>
                      <th>Sr. No.</th>
                      <th>Category</th>
                      <th>USD Amount</th>
                      <th>Min Amount Req</th>
                      <th>Amount Received</th>
                      <th>Min Amount Due</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1</td>
                      <td>SAMPLE DATA</td>
                      <td>700</td>
                      <td>300</td>
                      <td>200</td>
                      <td>100</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="payment-note">IMMEDIATE PAYMENT DUE AMOUNTING MVR : $700</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- All PO_PI Tracker Tab -->
<div class="tab-pane fade" id="po" role="tabpanel" aria-labelledby="po-tab">
  <div class="container-fluid p-3">
    <div class="d-flex flex-wrap align-items-center justify-content-between">
      <h6 class="mb-0 fw-bold text-primary">PO_PI Tracker</h6>
      <ul class="nav qt-property-tabs mx-auto" id="popiPropertyTabs" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="popiProperty1-tab" data-bs-toggle="tab" href="#popiProperty1" role="tab">Property 1</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="popiProperty2-tab" data-bs-toggle="tab" href="#popiProperty2" role="tab">Property 2</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="popiProperty3-tab" data-bs-toggle="tab" href="#popiProperty3" role="tab">Property 3</a>
        </li>
      </ul>
      <div class="qt-search-box d-flex">
        <input type="text" class="form-control form-control-sm" placeholder="Search..." id="popiGlobalSearch">
        <button type="button" class="ms-2" id="popiSearchButton">Search</button>
      </div>
    </div>
    <div class="btn-group qt-custom-btn-group py-3" role="group">
      <button type="button" class="btn" id="popiCopyButton">Copy</button>
      <button type="button" class="btn" id="popiCsvButton">CSV</button>
      <button type="button" class="btn" id="popiExcelButton">Excel</button>
      <button type="button" class="btn" id="popiPdfButton">PDF</button>
      <button type="button" class="btn" id="popiPrintButton">Print</button>
      <div class="qt-custom-select-wrapper">
        <select id="popiRowSelector">
          <option value="10">Show 10 Rows</option>
          <option value="25">Show 25 Rows</option>
          <option value="50">Show 50 Rows</option>
        </select>
        <i class="fa-solid fa-caret-down"></i>
      </div>
    </div>
    <div class="tab-content py-3">
      <div class="tab-pane fade show active" id="popiProperty1" role="tabpanel">
        <div class="table-responsive">
          <table id="popiTable1" class="table table-bordered table-striped nowrap qt-table" style="width:100%">
            <thead>
              <tr>
                <th>Client Name <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Categories <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>S No. <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Description <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>CENPRO Quote <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Resort PO <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Cenpro Pro Inv <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>PI Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>MVR Amount <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>USD Amount <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Minimum Payment <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Min Amount Required <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Amount Received <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Pay Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Paid% <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Total Amount Due <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Minimum Amount Due <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Shipping Mode <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>ETA <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>DN# <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>DN Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>TI# <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>TI Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>TI Amount <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Cenpro Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Resort Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
              </tr>
              <tr>
                <th><input type="text" placeholder="Client Name" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Categories" class="qt-filter-input"></th>
                <th><input type="text" placeholder="S No." class="qt-filter-input"></th>
                <th><input type="text" placeholder="Description" class="qt-filter-input"></th>
                <th><input type="text" placeholder="CENPRO Quote" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Resort PO" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Cenpro Pro Inv" class="qt-filter-input"></th>
                <th><input type="text" placeholder="PI Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="MVR Amount" class="qt-filter-input"></th>
                <th><input type="text" placeholder="USD Amount" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Minimum Payment" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Min Amount Required" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Amount Received" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Pay Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Paid%" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Total Amount Due" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Minimum Amount Due" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Shipping Mode" class="qt-filter-input"></th>
                <th><input type="text" placeholder="ETA" class="qt-filter-input"></th>
                <th><input type="text" placeholder="DN#" class="qt-filter-input"></th>
                <th><input type="text" placeholder="DN Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="TI#" class="qt-filter-input"></th>
                <th><input type="text" placeholder="TI Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="TI Amount" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Cenpro Remark" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Resort Remark" class="qt-filter-input"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Client A</td>
                <td>Category 1</td>
                <td>001</td>
                <td>Product Description</td>
                <td>10000</td>
                <td>PO-2001</td>
                <td>INV-3001</td>
                <td>01-Apr-25</td>
                <td>50000</td>
                <td>5000</td>
                <td>2500</td>
                <td>3000</td>
                <td>2000</td>
                <td>02-Apr-25</td>
                <td>50%</td>
                <td>3000</td>
                <td>1000</td>
                <td>Sea</td>
                <td>15-Apr-25</td>
                <td>DN-4001</td>
                <td>03-Apr-25</td>
                <td>TI-5001</td>
                <td>04-Apr-25</td>
                <td>4500</td>
                <td>Remark 1</td>
                <td>Resort Note 1</td>
              </tr>
              <tr>
                <td>Client B</td>
                <td>Category 2</td>
                <td>002</td>
                <td>Another Description</td>
                <td>15000</td>
                <td>PO-2002</td>
                <td>INV-3002</td>
                <td>02-Apr-25</td>
                <td>75000</td>
                <td>7500</td>
                <td>4000</td>
                <td>5000</td>
                <td>3000</td>
                <td>03-Apr-25</td>
                <td>40%</td>
                <td>4500</td>
                <td>2000</td>
                <td>Air</td>
                <td>20-Apr-25</td>
                <td>DN-4002</td>
                <td>04-Apr-25</td>
                <td>TI-5002</td>
                <td>05-Apr-25</td>
                <td>6000</td>
                <td>Remark 2</td>
                <td>Resort Note 2</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="tab-pane fade" id="popiProperty2" role="tabpanel">
        <div class="table-responsive">
          <table id="popiTable2" class="table table-bordered table-striped nowrap qt-table" style="width:100%">
            <thead>
              <tr>
                <th>Client Name <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Categories <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>S No. <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Description <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>CENPRO Quote <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Resort PO <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Cenpro Pro Inv <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>PI Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>MVR Amount <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>USD Amount <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Minimum Payment <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Min Amount Required <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Amount Received <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Pay Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Paid% <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Total Amount Due <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Minimum Amount Due <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Shipping Mode <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>ETA <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>DN# <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>DN Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>TI# <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>TI Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>TI Amount <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Cenpro Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Resort Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
              </tr>
              <tr>
                <th><input type="text" placeholder="Client Name" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Categories" class="qt-filter-input"></th>
                <th><input type="text" placeholder="S No." class="qt-filter-input"></th>
                <th><input type="text" placeholder="Description" class="qt-filter-input"></th>
                <th><input type="text" placeholder="CENPRO Quote" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Resort PO" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Cenpro Pro Inv" class="qt-filter-input"></th>
                <th><input type="text" placeholder="PI Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="MVR Amount" class="qt-filter-input"></th>
                <th><input type="text" placeholder="USD Amount" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Minimum Payment" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Min Amount Required" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Amount Received" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Pay Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Paid%" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Total Amount Due" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Minimum Amount Due" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Shipping Mode" class="qt-filter-input"></th>
                <th><input type="text" placeholder="ETA" class="qt-filter-input"></th>
                <th><input type="text" placeholder="DN#" class="qt-filter-input"></th>
                <th><input type="text" placeholder="DN Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="TI#" class="qt-filter-input"></th>
                <th><input type="text" placeholder="TI Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="TI Amount" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Cenpro Remark" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Resort Remark" class="qt-filter-input"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Client C</td>
                <td>Category 3</td>
                <td>003</td>
                <td>Item Description</td>
                <td>12000</td>
                <td>PO-2003</td>
                <td>INV-3003</td>
                <td>03-Apr-25</td>
                <td>60000</td>
                <td>6000</td>
                <td>3000</td>
                <td>3500</td>
                <td>2500</td>
                <td>04-Apr-25</td>
                <td>45%</td>
                <td>3500</td>
                <td>1500</td>
                <td>Land</td>
                <td>18-Apr-25</td>
                <td>DN-4003</td>
                <td>05-Apr-25</td>
                <td>TI-5003</td>
                <td>06-Apr-25</td>
                <td>5000</td>
                <td>Remark 3</td>
                <td>Resort Note 3</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="tab-pane fade" id="popiProperty3" role="tabpanel">
        <div class="table-responsive">
          <table id="popiTable3" class="table table-bordered table-striped nowrap qt-table" style="width:100%">
            <thead>
              <tr>
                <th>Client Name <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Categories <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>S No. <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Description <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>CENPRO Quote <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Resort PO <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Cenpro Pro Inv <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>PI Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>MVR Amount <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>USD Amount <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Minimum Payment <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Min Amount Required <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Amount Received <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Pay Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Paid% <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Total Amount Due <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Minimum Amount Due <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Shipping Mode <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>ETA <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>DN# <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>DN Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>TI# <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>TI Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>TI Amount <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Cenpro Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
                <th>Resort Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i class="fas fa-caret-down"></i></span></th>
              </tr>
              <tr>
                <th><input type="text" placeholder="Client Name" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Categories" class="qt-filter-input"></th>
                <th><input type="text" placeholder="S No." class="qt-filter-input"></th>
                <th><input type="text" placeholder="Description" class="qt-filter-input"></th>
                <th><input type="text" placeholder="CENPRO Quote" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Resort PO" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Cenpro Pro Inv" class="qt-filter-input"></th>
                <th><input type="text" placeholder="PI Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="MVR Amount" class="qt-filter-input"></th>
                <th><input type="text" placeholder="USD Amount" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Minimum Payment" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Min Amount Required" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Amount Received" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Pay Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Paid%" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Total Amount Due" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Minimum Amount Due" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Shipping Mode" class="qt-filter-input"></th>
                <th><input type="text" placeholder="ETA" class="qt-filter-input"></th>
                <th><input type="text" placeholder="DN#" class="qt-filter-input"></th>
                <th><input type="text" placeholder="DN Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="TI#" class="qt-filter-input"></th>
                <th><input type="text" placeholder="TI Date" class="qt-filter-input"></th>
                <th><input type="text" placeholder="TI Amount" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Cenpro Remark" class="qt-filter-input"></th>
                <th><input type="text" placeholder="Resort Remark" class="qt-filter-input"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Client D</td>
                <td>Category 4</td>
                <td>004</td>
                <td>Service Description</td>
                <td>18000</td>
                <td>PO-2004</td>
                <td>INV-3004</td>
                <td>04-Apr-25</td>
                <td>80000</td>
                <td>8000</td>
                <td>4000</td>
                <td>4500</td>
                <td>3500</td>
                <td>05-Apr-25</td>
                <td>55%</td>
                <td>4000</td>
                <td>2000</td>
                <td>Sea</td>
                <td>22-Apr-25</td>
                <td>DN-4004</td>
                <td>06-Apr-25</td>
                <td>TI-5004</td>
                <td>07-Apr-25</td>
                <td>7000</td>
                <td>Remark 4</td>
                <td>Resort Note 4</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="modal fade" id="popiEditModal" tabindex="-1" aria-labelledby="popiEditModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3 position-relative">
          <button class="qt-close-btn" data-bs-dismiss="modal">&times;</button>
          <h5 class="mb-2 fw-bold" id="popiEditModalLabel">Edit Cell</h5>
          <p class="text-muted mb-3" id="popiCellHeader"></p>
          <div class="modal-body p-0">
            <div class="mb-4">
              <input type="text" class="form-control" id="popiCellInput" placeholder="Enter value" />
            </div>
            <div class="d-flex justify-content-end gap-2">
              <button class="btn qt-btn-cancel" data-bs-dismiss="modal">Cancel</button>
              <button class="btn qt-btn-update" id="popiSubmitCell">Submit</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const popiTables = [
        document.getElementById("popiTable1"),
        document.getElementById("popiTable2"),
        document.getElementById("popiTable3")
      ];

      function getPopiTableData(table) {
        const headers = Array.from(table.querySelectorAll("thead tr:first-child th")).map(th => th.textContent.trim().replace(/[\u2191\u2193]/g, '').trim());
        const rows = Array.from(table.querySelectorAll("tbody tr")).map(row =>
          Array.from(row.cells).map(cell => cell.querySelector(".remark-text")?.textContent.trim() || cell.textContent.trim())
        );
        return [headers, ...rows];
      }

      function getActivePopiTable() {
        const activeTab = document.querySelector("#po .tab-pane.show.active");
        return activeTab ? activeTab.querySelector("table") : null;
      }

      const popiGlobalSearch = document.getElementById("popiGlobalSearch");
      const popiSearchButton = document.getElementById("popiSearchButton");
      function applyPopiGlobalSearch() {
        const table = getActivePopiTable();
        if (!table) return;
        const searchTerm = popiGlobalSearch.value.trim().toLowerCase();
        const tbody = table.tBodies[0];
        Array.from(tbody.rows).forEach(row => {
          const rowText = Array.from(row.cells).map(cell =>
            cell.querySelector(".remark-text")?.textContent.trim().toLowerCase() ||
            cell.textContent.trim().toLowerCase()
          ).join(" ");
          row.style.display = searchTerm ? rowText.includes(searchTerm) ? "" : "none" : "";
        });
      }
      popiGlobalSearch.addEventListener("input", applyPopiGlobalSearch);
      popiSearchButton.addEventListener("click", applyPopiGlobalSearch);

      const popiRowSelector = document.getElementById("popiRowSelector");
      function applyPopiRowLimit() {
        const table = getActivePopiTable();
        if (!table) return;
        const limit = parseInt(popiRowSelector.value);
        const tbody = table.tBodies[0];
        Array.from(tbody.rows).forEach((row, index) => {
          row.style.display = index < limit ? "" : "none";
        });
      }
      popiRowSelector.addEventListener("change", applyPopiRowLimit);

      document.getElementById("popiCopyButton").addEventListener("click", () => {
        const table = getActivePopiTable();
        if (!table) return;
        const data = getPopiTableData(table);
        const text = data.map(row => row.join("\t")).join("\n");
        navigator.clipboard.writeText(text).then(() => alert("Table data copied to clipboard!"));
      });

      document.getElementById("popiCsvButton").addEventListener("click", () => {
        const table = getActivePopiTable();
        if (!table) return;
        const data = getPopiTableData(table);
        const csv = data.map(row => row.map(cell => `"${cell.replace(/"/g, '""')}"`).join(",")).join("\n");
        const blob = new Blob([csv], { type: "text/csv" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "popi_tracker.csv";
        a.click();
        URL.revokeObjectURL(url);
      });

      document.getElementById("popiExcelButton").addEventListener("click", () => {
        const table = getActivePopiTable();
        if (!table) return;
        const data = getPopiTableData(table);
        const ws = XLSX.utils.aoa_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "PO_PI Tracker");
        XLSX.writeFile(wb, "popi_tracker.xlsx");
      });

      document.getElementById("popiPdfButton").addEventListener("click", () => {
        const table = getActivePopiTable();
        if (!table) return;
        const tableContainer = table.closest(".table-responsive");
        html2canvas(tableContainer, { scale: 2 }).then(canvas => {
          const imgData = canvas.toDataURL("image/png");
          const pdf = new window.jspdf.jsPDF({
            orientation: "landscape",
            unit: "px",
            format: [canvas.width, canvas.height]
          });
          pdf.addImage(imgData, "PNG", 0, 0, canvas.width, canvas.height);
          pdf.save("popi_tracker.pdf");
        });
      });

      document.getElementById("popiPrintButton").addEventListener("click", () => {
        const table = getActivePopiTable();
        if (!table) return;
        const printWindow = window.open("", "_blank");
        printWindow.document.write(`
          <html>
            <head>
              <title>Print PO_PI Tracker</title>
              <style>
                table { border-collapse: collapse; width: 100%; }
                th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
                th { background-color: #f2f2f2; }
              </style>
            </head>
            <body>
              ${table.outerHTML}
            </body>
          </html>
        `);
        printWindow.document.close();
        printWindow.print();
      });

      popiTables.forEach(table => {
        if (!table) return;

        const header = table.tHead.rows[0];
        const filterRowInputs = Array.from(table.querySelectorAll("thead tr:nth-child(2) input"));
        const tbody = table.tBodies[0];

        function refreshBlankCells() {
          Array.from(tbody.rows).forEach(row => {
            Array.from(row.cells).forEach((td, idx) => {
              const text = td.textContent.trim();
              const headerText = header.cells[idx].textContent.trim().replace(/[\u2191\u2193]/g, '').trim();
              td.innerHTML = "";

              const span = document.createElement("span");
              span.className = "remark-text";

              if (!text) {
                span.textContent = headerText;
                span.classList.add("text-missing");
                td.appendChild(span);

                const icon = document.createElement("i");
                icon.className = "fas fa-edit edit-icon";
                icon.title = "Edit";
                icon.setAttribute("data-col-index", idx);
                td.appendChild(icon);
              } else {
                span.textContent = text;
                td.appendChild(span);
              }
            });
          });
        }

        refreshBlankCells();

        function applyFilters() {
          Array.from(tbody.rows).forEach(row => {
            let show = true;
            filterRowInputs.forEach((input, i) => {
              const val = input.value.trim().toLowerCase();
              if (!val) return;
              const cell = row.cells[i];
              const txt = (cell.querySelector(".remark-text")?.textContent || cell.textContent).trim().toLowerCase();
              if (!txt.includes(val)) show = false;
            });
            row.style.display = show ? "" : "none";
          });
          applyPopiRowLimit();
        }
        filterRowInputs.forEach(inp => inp.addEventListener("input", applyFilters));

        let sortDirection = {};
        header.querySelectorAll("th").forEach((th, index) => {
          const icons = th.querySelector(".sort-icons");
          if (!icons) return;
          const [up, down] = icons.querySelectorAll("i");

          up.addEventListener("click", () => sortTable(index, "asc", up, down));
          down.addEventListener("click", () => sortTable(index, "desc", up, down));
        });

        function sortTable(colIndex, direction, up, down) {
          const rows = Array.from(tbody.rows);
          rows.sort((a, b) => {
            const aText = (a.cells[colIndex].querySelector(".remark-text")?.textContent || a.cells[colIndex].textContent).trim().toLowerCase();
            const bText = (b.cells[colIndex].querySelector(".remark-text")?.textContent || b.cells[colIndex].textContent).trim().toLowerCase();
            if (aText < bText) return direction === "asc" ? -1 : 1;
            if (aText > bText) return direction === "asc" ? 1 : -1;
            return 0;
          });
          tbody.append(...rows);

          header.querySelectorAll(".sort-icons i").forEach(i => i.classList.remove("sort-active"));
          if (direction === "asc") up.classList.add("sort-active");
          else down.classList.add("sort-active");
          applyPopiRowLimit();
        }

        tbody.addEventListener("click", (e) => {
          const icon = e.target.closest(".edit-icon");
          if (!icon) return;
          const td = icon.closest("td");
          popiCurrentCell = td;
          const colHeader = header.cells[icon.getAttribute("data-col-index")].textContent.trim().replace(/[\u2191\u2193]/g, '').trim();
          popiCellHeader.textContent = colHeader;
          popiCellInput.value = td.querySelector(".remark-text")?.textContent.replace(colHeader, "").trim() || "";
          popiEditModal.show();
        });
      });

      const popiModalEl = document.getElementById("popiEditModal");
      const popiEditModal = new bootstrap.Modal(popiModalEl);
      const popiCellInput = document.getElementById("popiCellInput");
      const popiCellHeader = document.getElementById("popiCellHeader");
      const popiSubmitBtn = document.getElementById("popiSubmitCell");
      let popiCurrentCell = null;

      popiSubmitBtn.addEventListener("click", () => {
        if (!popiCurrentCell) return;
        const val = popiCellInput.value.trim();
        const span = popiCurrentCell.querySelector(".remark-text");
        const header = popiCurrentCell.closest("table").tHead.rows[0];
        if (val) {
          span.textContent = val;
          span.classList.remove("text-missing");
          const icon = popiCurrentCell.querySelector(".edit-icon");
          if (icon) icon.remove();
        } else {
          span.textContent = header.cells[popiCurrentCell.cellIndex].textContent.trim().replace(/[\u2191\u2193]/g, '').trim();
          span.classList.add("text-missing");
          if (!popiCurrentCell.querySelector(".edit-icon")) {
            const icon = document.createElement("i");
            icon.className = "fas fa-edit edit-icon";
            icon.title = "Edit";
            icon.setAttribute("data-col-index", popiCurrentCell.cellIndex);
            popiCurrentCell.appendChild(icon);
          }
        }
        popiEditModal.hide();
        popiCurrentCell = null;
      });

      applyPopiRowLimit();
    });
  </script>
</div>

    <div class="tab-pane fade" id="quotation" role="tabpanel" aria-labelledby="quotation-tab">
      <style>
        .qt-property-tabs .nav-link {
          border-radius: 20px;
          padding: 5px 15px;
          color: #2f4e9b;
          border: 1px solid #2f4e9b;
          margin: 0 3px;
        }

        .qt-property-tabs .nav-link.active {
          background-color: #2f4e9b !important;
          color: #fff !important;
        }

        .qt-search-box input {
          border-radius: 20px;
          border: 1px solid #ccc;
        }

        .qt-search-box button {
          border-radius: 20px;
          background-color: #2f4e9b;
          color: #fff;
          border: none;
          padding: 5px 15px;
        }

        .qt-custom-btn-group .btn,
        .qt-custom-btn-group .qt-custom-select-wrapper {
          border: 1px solid #2f4e9b;
          border-radius: 0;
          background-color: #f8f9fa;
          font-size: 14px;
          padding: 4px 12px;
          height: 34px;
          display: flex;
          align-items: center;
        }

        .qt-custom-btn-group .btn:hover,
        .qt-custom-btn-group .qt-custom-select-wrapper:hover {
          background-color: #e9ecef;
        }

        .qt-custom-select-wrapper {
          position: relative;
        }

        .qt-custom-select-wrapper select {
          border: none;
          background: transparent;
          padding-right: 20px;
          font-size: 14px;
          height: 100%;
          appearance: none;
          outline: none;
        }

        .qt-custom-select-wrapper i {
          position: absolute;
          right: 10px;
          top: 50%;
          transform: translateY(-50%);
          pointer-events: none;
          font-size: 12px;
          color: #000;
        }

        .qt-table th,
        .qt-table td {
          min-width: 200px;
          text-align: center;
          white-space: nowrap;
          vertical-align: middle;
        }

        .qt-filter-input {
          width: 100%;
          font-size: 12px;
          padding: 6px 10px;
          box-sizing: border-box;
        }

        .edit-icon {
          cursor: pointer;
          margin-left: 0.5rem;
          color: #2f4e9b;
        }

        .edit-icon:hover {
          color: #0d6efd !important;
        }

        .qt-btn-cancel {
          background: #e9ecef;
        }

        .qt-btn-update {
          background: #0d6efd;
          color: #fff;
        }

        .qt-close-btn {
          background: none;
          border: none;
          font-size: 24px;
          position: absolute;
          right: 12px;
          top: 8px;
          cursor: pointer;
        }

        .text-missing {
          color: red;
          font-style: italic;
        }

        .qt-table th {
          position: relative;
          text-align: left;
          padding-right: 25px;
        }

        .sort-icons {
          position: absolute;
          right: 6px;
          top: 50%;
          transform: translateY(-50%);
          display: flex;
          flex-direction: column;
          align-items: center;
          font-size: 12px;
          cursor: pointer;
        }

        .sort-icons i {
          line-height: 10px;
        }

        .sort-active {
          color: #0d6efd;
          font-weight: bold;
        }
      </style>
      <div class="container-fluid p-3">
        <div class="d-flex flex-wrap align-items-center justify-content-between">
          <!-- Left: Title -->
          <h6 class="mb-0 fw-bold text-primary">Quotation Tracker</h6>
          <!-- Center: Property Tabs -->
          <ul class="nav qt-property-tabs mx-auto" id="propertyTabs" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" id="property1-tab" data-bs-toggle="tab" href="#property1" role="tab">Property
                1</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="property2-tab" data-bs-toggle="tab" href="#property2" role="tab">Property 2</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="property3-tab" data-bs-toggle="tab" href="#property3" role="tab">Property 3</a>
            </li>
          </ul>
          <!-- Right: Search -->
          <div class="qt-search-box d-flex">
            <input type="text" class="form-control form-control-sm" placeholder="Search..." id="globalSearch">
            <button type="button" class="ms-2" id="searchButton">Search</button>
          </div>
        </div>
        <!-- Button group -->
        <div class="btn-group qt-custom-btn-group py-3" role="group">
          <button type="button" class="btn" id="copyButton">Copy</button>
          <button type="button" class="btn" id="csvButton">CSV</button>
          <button type="button" class="btn" id="excelButton">Excel</button>
          <button type="button" class="btn" id="pdfButton">PDF</button>
          <button type="button" class="btn" id="printButton">Print</button>
          <div class="qt-custom-select-wrapper">
            <select id="rowSelector">
              <option value="10">Show 10 Rows</option>
              <option value="25">Show 25 Rows</option>
              <option value="50">Show 50 Rows</option>
            </select>
            <i class="fa-solid fa-caret-down"></i>
          </div>
        </div>
        <!-- Tab Content -->
        <div class="tab-content py-3">
          <!-- Property 1 Tab -->
          <div class="tab-pane fade show active" id="property1" role="tabpanel">
            <div class="table-responsive">
              <table id="quotationTable1" class="table table-bordered table-striped nowrap qt-table" style="width:100%">
                <thead>
                  <tr>
                    <th>Enquiry Number <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Enq. Received Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Senders Email ID <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Client Name <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Email Subject Line <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Product Category <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Assigned To <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>SLA <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Enq. Product Status <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Quotation Sent Status <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Zoho Quotation No. <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Multiple Quotation <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Quotation Sent Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>SLA Status <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>CENPRO Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Resort Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                  </tr>
                  <tr>
                    <th><input type="text" placeholder="Enq. No" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Rec. Date" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Email ID" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Name" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Subject" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Category" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Assigned To" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="SLA" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Search by status" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Sent status" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Quote No." class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Quotation Count" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Search by Date" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Check Status" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Remark" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Remark" class="qt-filter-input"></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>2025-1</td>
                    <td>20-Mar-25</td>
                    <td></td>
                    <td></td>
                    <td>Email Subject</td>
                    <td>Category 1</td>
                    <td>Group 1</td>
                    <td>12 Days</td>
                    <td>Completed</td>
                    <td>Completed</td>
                    <td>50</td>
                    <td>50</td>
                    <td>20-Mar-25</td>
                    <td>Within SLA</td>
                    <td>OK</td>
                    <td>Remark 1</td>
                  </tr>
                  <tr>
                    <td>2025-2</td>
                    <td></td>
                    <td>m.kumar@wisetrack.io</td>
                    <td>Wisetrack</td>
                    <td>Email Subject</td>
                    <td>Category 2</td>
                    <td>Group 1</td>
                    <td>12 Days</td>
                    <td>Completed</td>
                    <td>Completed</td>
                    <td>50</td>
                    <td>50</td>
                    <td>20-Mar-25</td>
                    <td>Within SLA</td>
                    <td>OK</td>
                    <td>Remark 2</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <!-- Property 2 Tab -->
          <div class="tab-pane fade" id="property2" role="tabpanel">
            <div class="table-responsive">
              <table id="quotationTable2" class="table table-bordered table-striped nowrap qt-table" style="width:100%">
                <thead>
                  <tr>
                    <th>Enquiry Number <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Enq. Received Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Senders Email ID <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Client Name <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Email Subject Line <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Product Category <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Assigned To <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>SLA <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Enq. Product Status <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Quotation Sent Status <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Zoho Quotation No. <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Multiple Quotation <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Quotation Sent Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>SLA Status <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>CENPRO Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Resort Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                  </tr>
                  <tr>
                    <th><input type="text" placeholder="Enq. No" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Rec. Date" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Email ID" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Name" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Subject" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Category" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Assigned To" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="SLA" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Search by status" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Sent status" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Quote No." class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Quotation Count" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Search by Date" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Check Status" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Remark" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Remark" class="qt-filter-input"></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>2025-3</td>
                    <td>21-Mar-25</td>
                    <td>contact@property2.com</td>
                    <td>Client A</td>
                    <td>Email Subject A</td>
                    <td>Category A</td>
                    <td>Group 2</td>
                    <td>10 Days</td>
                    <td>Pending</td>
                    <td>Not Sent</td>
                    <td>51</td>
                    <td>1</td>
                    <td>21-Mar-25</td>
                    <td>Within SLA</td>
                    <td>Pending</td>
                    <td>Remark A</td>
                  </tr>
                  <tr>
                    <td>2025-4</td>
                    <td>22-Mar-25</td>
                    <td></td>
                    <td></td>
                    <td>Email Subject B</td>
                    <td>Category B</td>
                    <td>Group 2</td>
                    <td>15 Days</td>
                    <td>Completed</td>
                    <td>Completed</td>
                    <td>52</td>
                    <td>2</td>
                    <td>22-Mar-25</td>
                    <td>Within SLA</td>
                    <td>OK</td>
                    <td>Remark B</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <!-- Property 3 Tab -->
          <div class="tab-pane fade" id="property3" role="tabpanel">
            <div class="table-responsive">
              <table id="quotationTable3" class="table table-bordered table-striped nowrap qt-table" style="width:100%">
                <thead>
                  <tr>
                    <th>Enquiry Number <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Enq. Received Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Senders Email ID <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Client Name <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Email Subject Line <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Product Category <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Assigned To <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>SLA <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Enq. Product Status <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Quotation Sent Status <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Zoho Quotation No. <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Multiple Quotation <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Quotation Sent Date <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>SLA Status <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>CENPRO Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                    <th>Resort Remark <span class="sort-icons"><i class="fas fa-caret-up"></i><i
                          class="fas fa-caret-down"></i></span></th>
                  </tr>
                  <tr>
                    <th><input type="text" placeholder="Enq. No" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Rec. Date" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Email ID" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Name" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Subject" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Category" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Assigned To" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="SLA" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Search by status" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Sent status" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Quote No." class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Quotation Count" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Search by Date" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Check Status" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Remark" class="qt-filter-input"></th>
                    <th><input type="text" placeholder="Enter Remark" class="qt-filter-input"></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>2025-5</td>
                    <td>23-Mar-25</td>
                    <td>contact@property3.com</td>
                    <td>Client X</td>
                    <td>Email Subject X</td>
                    <td>Category X</td>
                    <td>Group 3</td>
                    <td>8 Days</td>
                    <td>In Progress</td>
                    <td>Not Sent</td>
                    <td>53</td>
                    <td>1</td>
                    <td>23-Mar-25</td>
                    <td>Within SLA</td>
                    <td>Pending</td>
                    <td>Remark X</td>
                  </tr>
                  <tr>
                    <td>2025-6</td>
                    <td>24-Mar-25</td>
                    <td></td>
                    <td></td>
                    <td>Email Subject Y</td>
                    <td>Category Y</td>
                    <td>Group 3</td>
                    <td>10 Days</td>
                    <td>Completed</td>
                    <td>Completed</td>
                    <td>54</td>
                    <td>3</td>
                    <td>24-Mar-25</td>
                    <td>Within SLA</td>
                    <td>OK</td>
                    <td>Remark Y</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <!-- Edit Modal -->
        <div class="modal fade" id="qtEditModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content p-3 position-relative">
              <button class="qt-close-btn" data-bs-dismiss="modal">&times;</button>
              <h5 class="mb-2 fw-bold" id="editModalLabel">Edit Cell</h5>
              <p class="text-muted mb-3" id="cellHeader"></p>
              <div class="modal-body p-0">
                <div class="mb-4">
                  <input type="text" class="form-control" id="cellInput" placeholder="Enter value" />
                </div>
                <div class="d-flex justify-content-end gap-2">
                  <button class="btn qt-btn-cancel" data-bs-dismiss="modal">Cancel</button>
                  <button class="btn qt-btn-update" id="submitCell">Submit</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script>
        document.addEventListener("DOMContentLoaded", () => {
          const tables = [
            document.getElementById("quotationTable1"),
            document.getElementById("quotationTable2"),
            document.getElementById("quotationTable3")
          ];
          const { jsPDF } = window.jspdf;

          // Function to get table data as an array
          function getTableData(table) {
            const headers = Array.from(table.querySelectorAll("thead tr:first-child th")).map(th => th.textContent.trim().replace(/[\u2191\u2193]/g, '').trim());
            const rows = Array.from(table.querySelectorAll("tbody tr")).map(row =>
              Array.from(row.cells).map(cell => cell.querySelector(".remark-text")?.textContent.trim() || cell.textContent.trim())
            );
            return [headers, ...rows];
          }

          // Function to get the active table in Quotation Tracker tab
          function getActiveTable() {
            // Only look for active tab inside Quotation Tracker
            const activeTab = document.querySelector("#quotation .tab-pane.show.active");
            return activeTab ? activeTab.querySelector("table") : null;
          }

          // Search functionality
          const globalSearch = document.getElementById("globalSearch");
          const searchButton = document.getElementById("searchButton");
          function applyGlobalSearch() {
            const table = getActiveTable();
            if (!table) return;
            const searchTerm = globalSearch.value.trim().toLowerCase();
            const tbody = table.tBodies[0];
            Array.from(tbody.rows).forEach(row => {
              const rowText = Array.from(row.cells).map(cell =>
                cell.querySelector(".remark-text")?.textContent.trim().toLowerCase() ||
                cell.textContent.trim().toLowerCase()
              ).join(" ");
              row.style.display = searchTerm ? rowText.includes(searchTerm) ? "" : "none" : "";
            });
          }
          globalSearch.addEventListener("input", applyGlobalSearch);
          searchButton.addEventListener("click", applyGlobalSearch);

          // Row selector functionality
          const rowSelector = document.getElementById("rowSelector");
          function applyRowLimit() {
            const table = getActiveTable();
            if (!table) return;
            const limit = parseInt(rowSelector.value);
            const tbody = table.tBodies[0];
            Array.from(tbody.rows).forEach((row, index) => {
              row.style.display = index < limit ? "" : "none";
            });
          }
          rowSelector.addEventListener("change", applyRowLimit);

          // Copy button
          document.getElementById("copyButton").addEventListener("click", () => {
            const table = getActiveTable();
            if (!table) return;
            const data = getTableData(table);
            const text = data.map(row => row.join("\t")).join("\n");
            navigator.clipboard.writeText(text).then(() => alert("Table data copied to clipboard!"));
          });

          // CSV button
          document.getElementById("csvButton").addEventListener("click", () => {
            const table = getActiveTable();
            if (!table) return;
            const data = getTableData(table);
            const csv = data.map(row => row.map(cell => `"${cell.replace(/"/g, '""')}"`).join(",")).join("\n");
            const blob = new Blob([csv], { type: "text/csv" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "quotation_tracker.csv";
            a.click();
            URL.revokeObjectURL(url);
          });

          // Excel button
          document.getElementById("excelButton").addEventListener("click", () => {
            const table = getActiveTable();
            if (!table) return;
            const data = getTableData(table);
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Quotation Tracker");
            XLSX.writeFile(wb, "quotation_tracker.xlsx");
          });

          // PDF button
          document.getElementById("pdfButton").addEventListener("click", () => {
            const table = getActiveTable();
            if (!table) return;
            const tableContainer = table.closest(".table-responsive");
            html2canvas(tableContainer, { scale: 2 }).then(canvas => {
              const imgData = canvas.toDataURL("image/png");
              const pdf = new jsPDF({
                orientation: "landscape",
                unit: "px",
                format: [canvas.width, canvas.height]
              });
              pdf.addImage(imgData, "PNG", 0, 0, canvas.width, canvas.height);
              pdf.save("quotation_tracker.pdf");
            });
          });

          // Print button
          document.getElementById("printButton").addEventListener("click", () => {
            const table = getActiveTable();
            if (!table) return;
            const printWindow = window.open("", "_blank");
            printWindow.document.write(`
      <html>
        <head>
          <title>Print Quotation Tracker</title>
          <style>
            table { border-collapse: collapse; width: 100%; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
            th { background-color: #f2f2f2; }
          </style>
        </head>
        <body>
          ${table.outerHTML}
        </body>
      </html>
    `);
            printWindow.document.close();
            printWindow.print();
          });

          tables.forEach(table => {
            if (!table) return;

            const header = table.tHead.rows[0];
            const filterRowInputs = Array.from(table.querySelectorAll("thead tr:nth-child(2) input"));
            const tbody = table.tBodies[0];

            function refreshBlankCells() {
              Array.from(tbody.rows).forEach(row => {
                Array.from(row.cells).forEach((td, idx) => {
                  const text = td.textContent.trim();
                  const headerText = header.cells[idx].textContent.trim().replace(/[\u2191\u2193]/g, '').trim();
                  td.innerHTML = "";

                  const span = document.createElement("span");
                  span.className = "remark-text";

                  if (!text) {
                    span.textContent = headerText;
                    span.classList.add("text-missing");
                    td.appendChild(span);

                    const icon = document.createElement("i");
                    icon.className = "fas fa-edit edit-icon";
                    icon.title = "Edit";
                    icon.setAttribute("data-col-index", idx);
                    td.appendChild(icon);
                  } else {
                    span.textContent = text;
                    td.appendChild(span);
                  }
                });
              });
            }

            refreshBlankCells();

            function applyFilters() {
              Array.from(tbody.rows).forEach(row => {
                let show = true;
                filterRowInputs.forEach((input, i) => {
                  const val = input.value.trim().toLowerCase();
                  if (!val) return;
                  const cell = row.cells[i];
                  const txt = (cell.querySelector(".remark-text")?.textContent || cell.textContent).trim().toLowerCase();
                  if (!txt.includes(val)) show = false;
                });
                row.style.display = show ? "" : "none";
              });
              applyRowLimit();
            }
            filterRowInputs.forEach(inp => inp.addEventListener("input", applyFilters));

            let sortDirection = {};
            header.querySelectorAll("th").forEach((th, index) => {
              const icons = th.querySelector(".sort-icons");
              if (!icons) return;
              const [up, down] = icons.querySelectorAll("i");

              up.addEventListener("click", () => sortTable(index, "asc", up, down));
              down.addEventListener("click", () => sortTable(index, "desc", up, down));
            });

            function sortTable(colIndex, direction, up, down) {
              const rows = Array.from(tbody.rows);
              rows.sort((a, b) => {
                const aText = (a.cells[colIndex].querySelector(".remark-text")?.textContent || a.cells[colIndex].textContent).trim().toLowerCase();
                const bText = (b.cells[colIndex].querySelector(".remark-text")?.textContent || b.cells[colIndex].textContent).trim().toLowerCase();
                if (aText < bText) return direction === "asc" ? -1 : 1;
                if (aText > bText) return direction === "asc" ? 1 : -1;
                return 0;
              });
              tbody.append(...rows);

              header.querySelectorAll(".sort-icons i").forEach(i => i.classList.remove("sort-active"));
              if (direction === "asc") up.classList.add("sort-active");
              else down.classList.add("sort-active");
              applyRowLimit();
            }

            tbody.addEventListener("click", (e) => {
              const icon = e.target.closest(".edit-icon");
              if (!icon) return;
              const td = icon.closest("td");
              currentCell = td;
              const colHeader = header.cells[icon.getAttribute("data-col-index")].textContent.trim().replace(/[\u2191\u2193]/g, '').trim();
              cellHeader.textContent = colHeader;
              cellInput.value = td.querySelector(".remark-text")?.textContent.replace(colHeader, "").trim() || "";
              editModal.show();
            });
          });

          const modalEl = document.getElementById("qtEditModal");
          const editModal = new bootstrap.Modal(modalEl);
          const cellInput = document.getElementById("cellInput");
          const cellHeader = document.getElementById("cellHeader");
          const submitBtn = document.getElementById("submitCell");
          let currentCell = null;

          submitBtn.addEventListener("click", () => {
            if (!currentCell) return;
            const val = cellInput.value.trim();
            const span = currentCell.querySelector(".remark-text");
            const header = currentCell.closest("table").tHead.rows[0];
            if (val) {
              span.textContent = val;
              span.classList.remove("text-missing");
              const icon = currentCell.querySelector(".edit-icon");
              if (icon) icon.remove();
            } else {
              span.textContent = header.cells[currentCell.cellIndex].textContent.trim().replace(/[\u2191\u2193]/g, '').trim();
              span.classList.add("text-missing");
              if (!currentCell.querySelector(".edit-icon")) {
                const icon = document.createElement("i");
                icon.className = "fas fa-edit edit-icon";
                icon.title = "Edit";
                icon.setAttribute("data-col-index", currentCell.cellIndex);
                currentCell.appendChild(icon);
              }
            }
            editModal.hide();
            currentCell = null;
          });

          // Initialize row limit on page load
          applyRowLimit();
        });
      </script>
    </div>
  </div>
  <!-- Bootstrap JS and Popper.js -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>